# Ввод, вывод, вывод ошибок и перенаправления, конвееры
## Стандартный ввод, вывод, вывод ошибок
Вывод делится на:

* результат работы программы (данные, для получения которых создавалась программа)
* сообщения о состоянии или об ошибках, извещающие о самочувствие программы

Согласно центральной идее UNIX, что "все сущее есть файл", команды (вроде `ls`) выводят:

* результаты в специальный файл `stdout` (standard output),
* сообщения о состоянии в файл `stderr`
* на вход принимает специальный файл `stdin`, который по умолчанию связан с клавиатурой

*Командная строка Linux. Полное руководство. 2-е межд. изд., стр. 88*

## Перенаправление вывода в файл с затиранием
```bash
$ ls > ls-output.txt
```
*Командная строка Linux. Полное руководство. 2-е межд. изд., стр. 90*

## Перенаправление вывода в файл с добавлением в конец
```bash
$ ls >> ls-output.txt
```
*Командная строка Linux. Полное руководство. 2-е межд. изд., стр. 90*

## Вариант очистки файла
```bash
$ > ls-output.txt
```
*Командная строка Linux. Полное руководство. 2-е межд. изд., стр. 90*

## Перенаправления стандартного вывода ошибок
```bash
$ ls 2> ls-error.txt
```
Командная оболочка ссылкается на ввода/вывода/ошибки как на файловые дескрипторы `0`, `1`, `2` соответственно.<br/>
*Командная строка Linux. Полное руководство. 2-е межд. изд., стр. 91*

## Перенаправление стандартного вывода и вывода ошибок в один файл
```bash
$ ls > ls-output.txt 2>&1
```
`2>&1` означает перенаправление файлового дескриптора 2 (вывод ошибок) в файловый дескриптор 1 (вывод)<br/>
При этом порядок **важен**. Если записать `2>&1 > ls-output.txt`, ошибки будут выведены на экран<br/>
Вторым вариантом (более современным) является:
```bash
$ ls &> ls-output.txt
```
`&>` перенаправляет и вывод и вывод ошибок одновременно<br/>
И для добавления в файл, а не затирания
```bash
$ ls &>> ls-output.txt
```
*Командная строка Linux. Полное руководство. 2-е межд. изд., стр. 91-92*

## Удаление нежелательного вывода ошибок
```bash
$ ls 2> /dev/null
```
*Командная строка Linux. Полное руководство. 2-е межд. изд., стр. 92*

## Конвейер
Ковейеры строятся при помощи `|`<br/>
К примеру
```bash
$ ls -l /usr/bin | less
```
*Командная строка Linux. Полное руководство. 2-е межд. изд., стр. 95*

## Отличие конвейера от перенаправления ">"
Оператор `>` связывает команду с файлом, а оператор `|` связывает вывод одной команды с вводом другой<br/>
*Командная строка Linux. Полное руководство. 2-е межд. изд., стр. 96*

## Фильтры
#### sort
```bash
$ ls /bin /usr/bin | sort | less
```
В выводе этой команды будет так
```bash
/bin:
/usr/bin:
NF
NF
VGAuthService
VGAuthService
X11
X11
[
[
aa-enabled
aa-enabled
aa-exec
aa-exec
...
```

#### uniq
```bash
$ ls /bin /usr/bin | sort | uniq | less
```
Вывод
```bash
/bin:
/usr/bin:
NF
VGAuthService
X11
[
aa-enabled
aa-exec
add-apt-repository
addpart
apport-bug
apport-cli
apport-collect
apport-unpack
appres
apropos
...
```

#### wc
Команда `wc` используется для подсчета числа строк, слов и байтов в файлах.
```bash
$ wc script
  47  136 1776 script
```
Без параметров, `wc` будет принимать данные со stdin.<br/>
Ее можно использовать в конвеерах
```bash
$ ls /bin /usr/bin | sort | uniq | wc -l
979
```
`-l` ограничивет вывод только числом строк. Таким образом, получили число полученных записей.<br/>
*Командная строка Linux. Полное руководство. 2-е межд. изд., стр. 95-97*

## tee
Команда `tee` создает T-образное разветвление в конвеере.<br/>
Программа копирует данные из stdin, копирует в stout (для дальнейшей работы контейнера) и в один или несколько файлов. Полезно для сохранения промежуточных результатов.
```bash
$ ls /bin /usr/bin | sort | tee sorted.txt | uniq | wc -l
979
$ tail sorted.txt
zgrep
zgrep
zipdetails
zipdetails
zless
zless
```
*Командная строка Linux. Полное руководство. 2-е межд. изд., стр. 99-100*