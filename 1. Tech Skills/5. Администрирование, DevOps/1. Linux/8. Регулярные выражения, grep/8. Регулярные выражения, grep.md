## Регулярное выражение
*Регулярное выражение* - это символическая форма записи, используемая для идентификации шаблонов в тексте<br/>
*Командная строка Linux. Полное руководство. 2-е межд. изд., стр. 281*

## Синтаксис grep
```bash
grep [параметры] регулярное выражение [файл...]
```
*Командная строка Linux. Полное руководство. 2-е межд. изд., стр. 282*

## Параметры команды grep

| Параметр | Длинный параметр        | Описание                                                                      |
| -------- | ----------------------- | ----------------------------------------------------------------------------- |
| `-i`     | `--ignore-case`         | Игнорировать регистр                                                          |
| `-v`     | `--invert-match`        | Выводить строки не содержащие совпадения                                      |
| `-c`     | `--count`               | Выводить число совпадений (или несовпадений при `v`)                          |
| `-l`     | `--files-with-matches`  | Вместо строк с совпадениями выводить только имена файлов с найдеными строками |
| `-L`     | `--files-without-match` | Выводить только имена файлов, где не найдено ни одного совпадения             |
| `-n`     | `--line-number`         | Выводить номер строки в файле                                                 |
| `-h`     | `--no-filename`         | Не выводить имя файла при поиске по нескольким файлам                         |

*Командная строка Linux. Полное руководство. 2-е межд. изд., стр. 282-283*

## Якоря в регулярных выражениях
Символ `^` и знак `$` в регулярных выражениях интерпретируются, как *якоря*.<br/>
`^` - начало строки<br/>
`$` - конец строки
```bash
$ ls /etc/ | grep ^cron
cron.d
cron.daily
cron.hourly
cron.monthly
cron.weekly
crontab
$ ls /etc/ | grep conf$
adduser.conf
ca-certificates.conf
dconf
debconf.conf
deluser.conf
e2scrub.conf
...
ucf.conf
xattr.conf
$ ls /etc/ | grep ^resolv.conf$
resolv.conf
```
*Командная строка Linux. Полное руководство. 2-е межд. изд., стр. 285*

## Квадратные скобки в регулярных выражениях
Используя квадратные скобки можно описать совпадение с одним символом из определенного множества.
```bash
$ cat fleet
VSD I
VSD II
ISD I
ISD II
SSD
ASD
SSSD
ESSD
$ grep [VI]SD fleet
VSD I
VSD II
ISD I
ISD II
```
*Командная строка Linux. Полное руководство. 2-е межд. изд., стр. 286*

## Отрицание в квадратных скобках в регулярных выражениях
Есил сразу после открывающей квадратной скобки стоит символ `^`, остальные символы множества интерпретируются как недопустимые в данной позиции.<br/>
Символ `^` не отменяет необходимости пристутствия символа в заданной позиции, он лишь требует, чтобы символ в этой позиции не принадлежал заданному множеству
```bash
$ grep [^VI]SD fleet
SSD
ASD
SSSD
ESSD
```
*Командная строка Linux. Полное руководство. 2-е межд. изд., стр. 287*

## Диапазоны значений в регулярных выражениях
```bash
$ ls /etc/ | grep ^[a-i]conf$
dconf
```
*Командная строка Linux. Полное руководство. 2-е межд. изд., стр. 288*

## Проблемы с диапазонами символов
Традиционные формы записи в виде диапазонов (`[A-Z]`, `[a-z]`) работают, но не всегда дают ожидаемый результат, поэтому лучше использовать именно классы символов<br/>
*Командная строка Linux. Полное руководство. 2-е межд. изд., стр. 62*

## Дефис в диапазонев регулрных выражениях
Чтобы добавить `-` в диапазон, нужно ставить его вначале, чтобы он не интерпретировался, как специальный символ<br/>
*Командная строка Linux. Полное руководство. 2-е межд. изд., стр. 288*

## Классы символов POSIX

| Класс символов | Описание                                                         |
| -------------- | ---------------------------------------------------------------- |
| `[:alnum:]`    | Эквивалент `[A-Za-z0-9]` в ASCII                                 |
| `[:word:]`     | То же, что и `[:alnum:]`, с дополнительным символов `_`          |
| `[:alpha:]`    | Эквивалент `[A-Za-z]` в ASCII                                    |
| `[:blank:]`    | Символы пробела и табуляции                                      |
| `[:cntrl:]`    | Упарвляющие символы ASCII                                        |
| `[:digit:]`    | Цифры от 0 до 9                                                  |
| `[:graph:]`    | Отображаемые символы ASCII с кодами от 33 до 126                 |
| `[:lower:]`    | Символы нижнего регистра                                         |
| `[:punct:]`    | Эквивалент `[-!"#$%&'()*+,./:;<=>?@[\\\]_{\|}~$]` в ASCII        |
| `[:print:]`    | Символы из `[:graph:]` и пробел                                  |
| `[:space:]`    | Эквивалент `[ \t\r\n\v\f]`                                       |
| `[:upper]`     | Символы верхнего регистра                                        |
| `[:xdigit:]`   | Символы, используемые в 16-ной системе. Эквивалент `[0-9A-Fa-f]` |

*Командная строка Linux. Полное руководство. 2-е межд. изд., стр. 290*

## Групповые символы и классы символов в ls
### Групповые символы

| Групповой символ | Соответствие                                                 |
| ---------------- | ------------------------------------------------------------ |
| `*`              | Любая последовательность любых символов                      |
| `?`              | Любой один символ                                            |
| `[символы]`      | Любой один символ из указанного множества символов           |
| `[!символы]`     | Любой символ, не принадлежащий указанному множеству символов |
| `[[:класс]]`     | Любой символ принадлежащий указанному классу                 |

*Командная строка Linux. Полное руководство. 2-е межд. изд., стр. 60*

### Наиболее часто используемые классы символов

| Класс символов | Соотвестсвует                    |
| -------------- | -------------------------------- |
| `[[:alnum:]]`  | Любой альфавитно-цифровой символ |
| `[[:alpha:]]`  | Любой алфавитный символ          |
| `[[:digit:]]`  | Любой цифровой символ            |
| `[[:lower:]]`  | Любая буква в нижнем регистре    |
| `[[:upper:]]`  | Любая буква в верхнем регистре   |

```bash
$ ls /mnt/c/Documents\ and\ Settings/Aleksei_Khitev/Downloads/[S]*.torrent
'/mnt/c/Documents and Settings/Aleksei_Khitev/Downloads/Star.Trek.Picard.S02E02.1080p.rus.LostFilm.TV.mkv.torrent'
'/mnt/c/Documents and Settings/Aleksei_Khitev/Downloads/Star.Trek.Picard.S02E03.1080p.rus.LostFilm.TV.mkv.torrent'
'/mnt/c/Documents and Settings/Aleksei_Khitev/Downloads/Star.Trek.Picard.S02E04.1080p.rus.LostFilm.TV.mkv.torrent'
```
```bash
$ ls /mnt/c/Documents\ and\ Settings/Aleksei_Khitev/Downloads/[[:lower:]]*.zip
'/mnt/c/Documents and Settings/Aleksei_Khitev/Downloads/takeout-20220316T065659Z-001.zip'
```
```bash
$ ls /mnt/c/Documents\ and\ Settings/Aleksei_Khitev/Downloads/[ST]*.torrent
'/mnt/c/Documents and Settings/Aleksei_Khitev/Downloads/Star.Trek.Picard.S02E02.1080p.rus.LostFilm.TV.mkv.torrent'
'/mnt/c/Documents and Settings/Aleksei_Khitev/Downloads/Star.Trek.Picard.S02E03.1080p.rus.LostFilm.TV.mkv.torrent'
'/mnt/c/Documents and Settings/Aleksei_Khitev/Downloads/Star.Trek.Picard.S02E04.1080p.rus.LostFilm.TV.mkv.torrent'
'/mnt/c/Documents and Settings/Aleksei_Khitev/Downloads/The.Walking.Dead.S11E01.1080p.rus.LostFilm.TV.mkv.torrent'
'/mnt/c/Documents and Settings/Aleksei_Khitev/Downloads/The.Walking.Dead.S11E12.1080p.rus.LostFilm.TV.mkv.torrent'
'/mnt/c/Documents and Settings/Aleksei_Khitev/Downloads/The.Walking.Dead.S11E13.1080p.rus.LostFilm.TV.mkv.torrent'
'/mnt/c/Documents and Settings/Aleksei_Khitev/Downloads/The.Walking.Dead.S11E14.1080p.rus.LostFilm.TV.mkv.torrent'
```
*Командная строка Linux. Полное руководство. 2-е межд. изд., стр. 60*

## Чередование (ИЛИ) в регулярных выражениях
```bash
$ echo ISD | grep -E 'ISD|ИЗР'
ISD
$ echo ИЗР | grep -E 'ISD|ИЗР'
ИЗР
$ echo SSD | grep -E 'ISD|ИЗР'
$
```
*Командная строка Linux. Полное руководство. 2-е межд. изд., стр. 294*

## Чередования и скобки в регулрных выражениях
Для объединения с другими элементами регулярного выражения, чередование можно заключать в круглые скобки.<br/>
Если этого не сделать, то к примеру `grep -E '^VSD|ISD'` будет означать найти строку, начинающуюся с `VSD` или содержащую `ISD`
```bash
$ grep -E '^(VSD|ISD)' fleet
VSD I
VSD II
ISD I
ISD II
```
*Командная строка Linux. Полное руководство. 2-е межд. изд., стр. 294*

## Квантификаторы в регулярных выражениях
#### ? - ноль или один раз
```bash
$ grep -E \
> '^(8|[+]7)[ ]?[\(]?[0-9][0-9][0-9][\)]?[ ]?[0-9][0-9][0-9][-| ]?[0-9][0-9][-| ]?[0-9][0-9]' \
> phones
+7 901 755 10 33
8 901 755 10 33
+7 (901) 755 10 33
+7 (901) 755-10-33
+7(901)755-10-33
8(901)755-10-33-33-33
```
Тут пробелы и тире могут быть или не быть, так что они обознечены как `[ ]?` или `[-| ]?`

#### * - ноль или более раз
#### + - одил или более раз
#### {} - определенное число раз

| Спецификатор | Значение                                    |
| ------------ | ------------------------------------------- |
| `{n}`        | встречается ровно `n` раз                   |
| `{n,m}`      | встречается не менее `n` и не более `m` раз |
| `{n,}`       | встречается `n` и более раз                 |
| `{,m}`       | встречается не более `m` раз                |

```bash
$ grep -E \
> '^(8|[+]7)[ ]?[\(]?[0-9]{3}[\)]?[ ]?[0-9]{3}[-| ]?[0-9]{2}[-| ]?[0-9]{2}' \
> phones
+7 901 755 10 33
8 901 755 10 33
+7 (901) 755 10 33
+7 (901) 755-10-33
+7(901)755-10-33
8(901)755-10-33-10-33
```
*Командная строка Linux. Полное руководство. 2-е межд. изд., стр. 295-267*